#!/usr/bin/env bash
#
# Toggle Do Not Disturb mode in Mako and sync with PipeWire metadata

set -euo pipefail

makoctl mode -t do-not-disturb

if makoctl mode | grep -q 'do-not-disturb'; then
    pw-metadata -n default 0 dnd-mode true
else
    pw-metadata -n default 0 dnd-mode false
fi

pkill -SIGRTMIN+8 waybar || true
